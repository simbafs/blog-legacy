<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Yubikey æ„Ÿè¬ç…¥æ°è³£æˆ‘ä¸€å€‹ 1200ï¼Œæ’¿åˆ°å¯¶å•¦ï¼æˆ‘è²·çš„æ˜¯ Yubikey 5C NFCï¼Œçœ‹èµ·ä¾†å¹¾ä¹æ‰€æœ‰åŠŸèƒ½éƒ½æœ‰ login å¦‚æœé–‹å•Ÿé€™å€‹ï¼Œç™»å…¥ã€è§£é™¤é–å®šç­‰ç­‰å‹•ä½œéƒ½éœ€è¦ Yubikeyï¼Œ"><title>Yubikey</title><link rel=canonical href=https://blog.simbafs.cc/p/linux/yubikey/><link rel=stylesheet href=/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css><meta property="og:title" content="Yubikey"><meta property="og:description" content="Yubikey æ„Ÿè¬ç…¥æ°è³£æˆ‘ä¸€å€‹ 1200ï¼Œæ’¿åˆ°å¯¶å•¦ï¼æˆ‘è²·çš„æ˜¯ Yubikey 5C NFCï¼Œçœ‹èµ·ä¾†å¹¾ä¹æ‰€æœ‰åŠŸèƒ½éƒ½æœ‰ login å¦‚æœé–‹å•Ÿé€™å€‹ï¼Œç™»å…¥ã€è§£é™¤é–å®šç­‰ç­‰å‹•ä½œéƒ½éœ€è¦ Yubikeyï¼Œ"><meta property="og:url" content="https://blog.simbafs.cc/p/linux/yubikey/"><meta property="og:site_name" content="Simba çš„å–µçª©"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="yubikey"><meta property="article:tag" content="ssh"><meta property="article:tag" content="gpg"><meta property="article:tag" content="security"><meta property="article:published_time" content="2022-04-19T00:00:00+00:00"><meta property="article:modified_time" content="2022-04-19T00:00:00+00:00"><meta property="og:image" content="https://blog.simbafs.cc/og/linux/yubikey.png"><meta name=twitter:site content="@simbafs"><meta name=twitter:creator content="@simbafs"><meta name=twitter:title content="Yubikey"><meta name=twitter:description content="Yubikey æ„Ÿè¬ç…¥æ°è³£æˆ‘ä¸€å€‹ 1200ï¼Œæ’¿åˆ°å¯¶å•¦ï¼æˆ‘è²·çš„æ˜¯ Yubikey 5C NFCï¼Œçœ‹èµ·ä¾†å¹¾ä¹æ‰€æœ‰åŠŸèƒ½éƒ½æœ‰ login å¦‚æœé–‹å•Ÿé€™å€‹ï¼Œç™»å…¥ã€è§£é™¤é–å®šç­‰ç­‰å‹•ä½œéƒ½éœ€è¦ Yubikeyï¼Œ"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.simbafs.cc/og/linux/yubikey.png"><script async src="https://www.googletagmanager.com/gtag/js?id=G-DTMEFY7DTF"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-DTMEFY7DTF")</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"dark")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ›é¸å–®>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hua1d55c26052b345e2b49223d0087ef3a_89734_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>ğŸ’¤</span></figure><div class=site-meta><h1 class=site-name><a href=/>Simba çš„å–µçª©</a></h1><h2 class=site-description>æˆå¤§ç‰©ç†ç³»å¤§ä¸‰</h2></div></header><ol class=social-menu><li><a href=https://github.com/simbafs target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=/index.xml target=_blank title=RSS rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li><li><a href=https://twitter.com/simbafs target=_blank title=Twitter rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/index/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>å¤œæ™šæ¨¡å¼</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®éŒ„</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#login>login</a></li><li><a href=#ssh-gpg>ssh gpg</a></li><li><a href=#2fa>2FA</a></li><li><a href=#20221207-æ›´>2022/12/07 æ›´</a></li><li><a href=#å¯†ç¢¼å€‘>å¯†ç¢¼å€‘</a></li><li><a href=#pin>PIN</a><ol><li><a href=#ä½¿ç”¨æƒ…å¢ƒ>ä½¿ç”¨æƒ…å¢ƒ</a></li></ol></li><li><a href=#puk>PUK</a><ol><li><a href=#ä½¿ç”¨æƒ…å¢ƒ-1>ä½¿ç”¨æƒ…å¢ƒ</a></li></ol></li><li><a href=#admin-pin>Admin PIN</a></li><li><a href=#management-key>management key</a><ol><li><a href=#ä½¿ç”¨æƒ…å¢ƒ-2>ä½¿ç”¨æƒ…å¢ƒ</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/linux/yubikey/><img src=/og/linux/yubikey.png loading=lazy alt="Featured image of post Yubikey"></a></div><div class=article-details><header class=article-category><a href=/categories/linux/>linux</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/linux/yubikey/>Yubikey</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>2022/04/19</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>é–±è®€æ™‚é–“: 4 åˆ†é˜</time></div></footer></div></header><section class=article-content><h1 id=yubikey>Yubikey</h1><p>æ„Ÿè¬ç…¥æ°è³£æˆ‘ä¸€å€‹ 1200ï¼Œæ’¿åˆ°å¯¶å•¦ï¼æˆ‘è²·çš„æ˜¯ <a class=link href=https://www.yubico.com/tw/product/yubikey-5c-nfc/ target=_blank rel=noopener>Yubikey 5C NFC</a>ï¼Œçœ‹èµ·ä¾†å¹¾ä¹æ‰€æœ‰åŠŸèƒ½éƒ½æœ‰</p><h2 id=login>login</h2><p>å¦‚æœé–‹å•Ÿé€™å€‹ï¼Œç™»å…¥ã€è§£é™¤é–å®šç­‰ç­‰å‹•ä½œéƒ½éœ€è¦ Yubikeyï¼Œè½èµ·é‚„å¾ˆå®‰å…¨ï¼Œä½†æ˜¯å› ç‚ºæˆ‘çš„ç­†é›»åªæœ‰ä¸€å€‹ type Cï¼Œæ‰€ä»¥å¿…é ˆæŠŠ USB hub æ‹”æ‰ï¼ŒæŒºéº»ç…©ï¼Œæˆ‘å°±æŠŠä»–é—œæ‰äº†ã€‚<br>åœ¨å¯†ç¢¼è¼¸å…¥æ¡†çš„åœ°æ–¹ï¼Œå…ˆæ’å…¥ yubikeyï¼Œè¼¸å…¥å¯†ç¢¼ã€æŒ‰ enterï¼Œç„¶å¾Œè½‰åœˆåœˆçš„æ™‚å€™æŒ‰ yubikey ä¸Šé‡‘è‰²æŒ‰éˆ•ï¼ˆé€™å€‹ä¼¼ä¹æ˜¯æŒ‡ç´‹è¾¨è­˜ï¼‰ï¼Œå°±å¯ä»¥ç™»å…¥äº†ã€‚</p><blockquote><p><a class=link href=https://oscfr.com/blog/tech/yubico-yubikey-5c-nfc-setup-on-ubuntu-2104/ target=_blank rel=noopener>Yubico Yubikey 5C NFC setup on Ubuntu 21.04</a></p></blockquote><h2 id=ssh-gpg>ssh gpg</h2><p><del>ç ”ç©¶ä¸­&mldr;</del>
åœ¨é€™è£¡ <a class=link href=/posts/linux/gpg-with-ssh>GPG with SSH</a></p><blockquote><p><a class=link href=https://medium.com/@SSWilsonKao/%E5%A6%82%E4%BD%95%E5%9C%A8-mac-%E4%B8%8A-%E6%8A%8A-yubikey-%E8%88%87-gpg-ssh-%E6%90%AD%E9%85%8D%E5%9C%A8%E4%B8%80%E8%B5%B7-5f842d20ad6a target=_blank rel=noopener>å¦‚ä½•åœ¨ Mac ä¸Šï¼ŒæŠŠ YubiKey èˆ‡ GPGã€SSH æ­é…åœ¨ä¸€èµ·</a> > <a class=link href=https://gist.github.com/artizirk/d09ce3570021b0f65469cb450bee5e29 target=_blank rel=noopener>OpenPGP SSH access with Yubikey and GnuPG</a></p></blockquote><h2 id=2fa>2FA</h2><p>æŒ‰ç…§å„å€‹ç¶²ç«™çš„èªªæ˜è¨­å®šï¼Œä¸‹é¢æ˜¯æˆ‘æ‰¾åˆ°å¯ä»¥è¨­å®š Yubikey çš„ç¶²ç«™/APP</p><ul><li>Googleï¼ˆæˆ‘è²·é€™å€‹ yubikey æœ€ä¸»è¦ç›®çš„ï¼‰</li><li>Github</li><li>twitter</li><li>facebook</li><li>heroku</li></ul><p>twitter åœ¨æ‰‹æ©Ÿç™»å…¥å¥½åƒæ€ªæ€ªçš„ï¼Œè©¦äº† 5 åˆ†é˜æ‰æˆåŠŸç™»å…¥äº†</p><hr><h2 id=20221207-æ›´>2022/12/07 æ›´</h2><p>éäº†ä¸€é™£å­ï¼Œç³»çµ±ä¹Ÿé‡è£éï¼Œç„¶å¾Œ yubikey å°±è®€ä¸åˆ°äº†ï¼Œä½†æ˜¯å¹³å¸¸ç”¨ç¶²ç«™éƒ½å¯ä»¥ï¼Œåªæ˜¯ CLI å’Œ Yubikey personalization tool éƒ½è®€ä¸åˆ°ã€‚
æ’ä¸Šå¾Œè¼¸å…¥ä»¥ä¸‹æŒ‡ä»¤éƒ½æœƒå¤±æ•—</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ykpersonalize
</span></span><span class=line><span class=cl>Yubikey core error: no yubikey present
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ ykman list --serials
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>WARNING: PC/SC not available. Smart card (CCID) protocols will not function.
</span></span><span class=line><span class=cl>ERROR: Unable to list devices for connection
</span></span><span class=line><span class=cl>15421961
</span></span></code></pre></td></tr></table></div></div><p>ä½†æ˜¯ç”¨ <code>lsusb</code> çœ‹èµ·ä¾†å»å¾ˆæ­£å¸¸</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ lsusb
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Bus 001 Device 010: ID 1050:0406 Yubico.com Yubikey 4/5 U2F+CCID
</span></span></code></pre></td></tr></table></div></div><p>ç›®å‰æ ¹æ“š <a class=link href=https://github.com/Yubico/yubioath-flutter/issues/786#issuecomment-1063656957 target=_blank rel=noopener>é€™å€‹ GitHub Issue çš„å›è¦†</a>ï¼Œè¼¸å…¥ <code>sudo systemctl start pcscd</code> å¾Œï¼Œè®Šæˆé€™æ¨£</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ykman list --serials
</span></span><span class=line><span class=cl>15421961
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘å‰›å‰›ç™¼ç¾ï¼Œè¼¸å…¥æŒ‡ä»¤ <code>ykman info</code> (yubikey manager) ç«Ÿç„¶æœ‰å›æ‡‰ï¼Œä¹Ÿæ‰¾å¾—åˆ°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ykman info
</span></span><span class=line><span class=cl>Device type: YubiKey 5C NFC
</span></span><span class=line><span class=cl>Serial number: 15421961
</span></span><span class=line><span class=cl>Firmware version: 5.2.7
</span></span><span class=line><span class=cl>Form factor: Keychain (USB-C)
</span></span><span class=line><span class=cl>Enabled USB interfaces: FIDO, CCID
</span></span><span class=line><span class=cl>NFC transport is enabled.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Applications    USB             NFC
</span></span><span class=line><span class=cl>OTP             Disabled        Enabled
</span></span><span class=line><span class=cl>FIDO U2F        Enabled         Enabled
</span></span><span class=line><span class=cl>FIDO2           Enabled         Enabled
</span></span><span class=line><span class=cl>OATH            Enabled         Enabled
</span></span><span class=line><span class=cl>PIV             Enabled         Enabled
</span></span><span class=line><span class=cl>OpenPGP         Enabled         Enabled
</span></span><span class=line><span class=cl>YubiHSM Auth    Not available   Not available
</span></span></code></pre></td></tr></table></div></div><p>ä½†æ˜¯ ykpersonalize é‚„æ˜¯æ‰¾ä¸åˆ°æˆ‘çš„ yubikeyï¼Œå¾Œä¾†æˆ‘ç›´æ¥è·³éé€™æ­¥ï¼Œèªªä¸å®šç¾åœ¨ gpg å·²ç¶“å¯ä»¥è®€åˆ°äº†ï¼Œæ‰€ä»¥æˆ‘ç›´æ¥åŸ·è¡Œ <code>gpg --edit-card</code>ï¼Œçµæœä»–èªª</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>gpg: error getting version from &#39;scdaemon&#39;: No SmartCard daemon
</span></span><span class=line><span class=cl>gpg: OpenPGP card not available: No SmartCard daemon
</span></span></code></pre></td></tr></table></div></div><p>æ ¹æ“š <a class=link href=https://www.reddit.com/r/yubikey/comments/lbl4nn/having_some_trouble_with_gpg_and_yubikey/ target=_blank rel=noopener>é€™ç¯‡ reddit</a>ï¼Œæ˜¯å°‘äº†å¥—ä»¶ <code>scdaemon</code>ï¼Œç”¨ apt è£äº†ä¹‹å¾Œ gpg çš„å›æ‡‰çœ‹èµ·ä¾†å°±æ­£å¸¸å¤šäº†</p><p>ç„¶å¾Œå°±è·Ÿè‘— [å®˜æ–¹ blog çš„èªªæ˜](<a class=link href=https://support.yubico.com/hc/en-us/articles/360013790259-Using-Your-YubiKey-with-OpenPGP#Generating_Keys_externally_from_the_YubiKey_%28Recommended%29ui6vup%29 target=_blank rel=noopener>https://support.yubico.com/hc/en-us/articles/360013790259-Using-Your-YubiKey-with-OpenPGP#Generating_Keys_externally_from_the_YubiKey_(Recommended%29ui6vup)</a> æŠŠä¸»å¯†é‘°ï¼ˆï¼Ÿå¥½åƒæ˜¯ç°½ç« ç”¨å­å¯†é‘°ï¼‰ç§»åˆ° yubikey ä¸Šäº†</p><p>æ¥ä¸‹ä¾†æˆ‘äº‚ä¸ƒå…«ç³Ÿè©¦äº†ä¸€å †æ±è¥¿ï¼Œç™¼ç¾ <a class=link href=https://developer.okta.com/blog/2021/07/07/developers-guide-to-gpg target=_blank rel=noopener>ä¸€ç¯‡æ–‡ç« </a> æŠŠä¸Šé¢çš„æ±è¥¿å¹¾ä¹éƒ½åŒ…æ‹¬é€²å»äº†ï¼Œéå¸¸æ¨è–¦å¯ä»¥å»çœ‹çœ‹ã€‚</p><p>å‰›å‰›æäº†ä¸€é™£å¾Œï¼ŒæŠŠç°½ç« ã€åŠ å¯†ã€é©—è­‰å’Œä¸»é‡‘é‘°ï¼ˆæ‡‰è©²æœ‰ï¼‰çš„å¯†é‘°é€šé€šä¸Ÿä¸Š yubikey äº†ã€‚ä½†æ˜¯ç¾åœ¨æœ‰å€‹å•é¡Œï¼Œæ‰€æœ‰éœ€è¦ gpg key çš„æ™‚å€™ï¼Œåƒæ˜¯ç°½ git commit å’Œ ssh é©—è­‰éƒ½éœ€è¦æ’ä¸Š yubikeyï¼Œå¥½åƒå®‰å…¨éé ­äº†ã€‚æˆ‘ç ”ç©¶çœ‹çœ‹èƒ½ä¸èƒ½æŠŠæŸäº›å†æ‹‰å›æœ¬åœ°ï¼Œå¦‚æœä¸è¡Œçš„è©±å°±åªèƒ½æŠŠä¸€é–‹å§‹å‚™ä»½çš„å¯†é‘°å†å°å…¥ä¸€æ¬¡ï¼Œæš´åŠ›è§£æ±ºï¼</p><h2 id=å¯†ç¢¼å€‘>å¯†ç¢¼å€‘</h2><p>yubikey çš„è¨­å®šä¸­æœ‰å¥½å¹¾ä»½ä¸åŒåŠŸèƒ½çš„å¯†ç¢¼ï¼Œç”¨æ³•å’Œå‡ºç¾æ™‚æ©Ÿéƒ½ä¸ä¸€æ¨£ï¼Œé€™é‚Šæ˜¯æˆ‘ç ”ç©¶å¥½å¹¾ä»½æ–‡ä»¶çš„ç¸½æ•´ç†ã€‚é¦–å…ˆè¦å…ˆæœ‰å€‹é—œå¿µï¼Œyubikey çš„è¨­è¨ˆæ˜¯å…¬å¸è£¡æœ‰å€‹äººå°ˆé–€ç®¡ä¸€å¤§å †çš„ yubikeyï¼Œæ‰€ä»¥æœƒæœ‰ä¸€å€‹å¯†ç¢¼æ˜¯åªæœ‰ç®¡ç†äººçŸ¥é“ï¼Œä½¿ç”¨è€…ä¸çŸ¥é“ã€‚é‚£ç‚ºäº†é©—è­‰æ˜¯ä½¿ç”¨è€…æœ¬äººï¼Œä¹Ÿæœƒæœ‰å¯†ç¢¼æ˜¯åªæœ‰ä½¿ç”¨è€…çŸ¥é“ä½†æ˜¯å…¶ä»–äººä¸çŸ¥é“ã€‚</p><h2 id=pin>PIN</h2><p>é€™å€‹ &ldquo;PIN&rdquo; æ˜¯ <strong>&ldquo;Personal Identification Number&rdquo;</strong> çš„ç¸®å¯«ï¼Œé¡§åæ€ç¾©ï¼Œé€™å€‹å°±æ˜¯åªæœ‰ä½¿ç”¨è€…çŸ¥é“ä½†æ˜¯å…¶ä»–äººä¸çŸ¥é“çš„ PINï¼Œä½ æœƒåœ¨å‹•ç”¨ gpgã€ssh å¯†é‘°æ™‚ç”¨åˆ°ä»–ã€‚é è¨­æ˜¯ 123456</p><h3 id=ä½¿ç”¨æƒ…å¢ƒ>ä½¿ç”¨æƒ…å¢ƒ</h3><ul><li>é©—è­‰ PIN</li><li>æ”¹è®Š PIN</li><li>æ”¹è®Šå˜—è©¦æ¬¡æ•¸é™åˆ¶ï¼ˆé‚„éœ€è¦ management keyï¼‰</li><li>ç°½ç« </li><li>è§£å¯†</li><li>key agreement</li><li>å–å¾—è³‡æ–™</li></ul><h2 id=puk>PUK</h2><p>&ldquo;PUK&rdquo; æ˜¯ &ldquo;PIN Unblocking Key&rdquo; çš„ç¸®å¯«ï¼Œä»–çš„åŠŸèƒ½æ˜¯ç•¶ä½ è¼¸å…¥éŒ¯èª¤çš„ PIN å¤ªå¤šæ¬¡æ™‚ï¼Œç”¨é€™å€‹å¯†ç¢¼è§£é–ã€‚å¦‚æœå¾ˆä¸å¹¸çš„ä½  PUK ä¹Ÿè¼¸å…¥éŒ¯èª¤å¤ªå¤šæ¬¡ï¼Œæ•´å€‹ yubikey æœƒè¢«é–èµ·ä¾†ï¼Œæ‰€æœ‰çš„åŠŸèƒ½éƒ½ä¸èƒ½ç”¨ï¼Œæ ¹æ“š <a class=link href=https://support.yubico.com/hc/en-us/articles/360015654100-YubiKey-PIN-and-PUK-User-Management-on-Windows target=_blank rel=noopener>å®˜æ–¹æ–‡ä»¶</a>ï¼Œä½ åªèƒ½å›å¾©å‡ºå» è¨­å®š</p><blockquote><p>By default, the user PIN is blocked when three consecutive incorrect PINs have been entered. The PIN Unblock Code (PUK) is used for unblocking the User PIN. If both the PIN and the PUK are blocked, the YubiKey must be reset, which deletes any loaded certificates and returns the YubiKey to a factory default state.</p></blockquote><h3 id=ä½¿ç”¨æƒ…å¢ƒ-1>ä½¿ç”¨æƒ…å¢ƒ</h3><ul><li>ä¿®æ”¹ PUK</li><li>è§£é– PIN</li></ul><h2 id=admin-pin>Admin PIN</h2><p>å¾ˆæ˜é¡¯é€™æ˜¯ç®¡ç†å“¡å°ˆç”¨çš„å¯†ç¢¼ï¼Œåæ­£åœ¨éœ€è¦æ¯”è¼ƒé«˜æ¬Šé™çš„æ“ä½œçš„æ™‚å€™ä»–æœƒè·³å‡ºä¾†ï¼Œå¯†ç¢¼è¼¸å…¥æ¡†ä¸Šé¢æœƒå¯« &ldquo;Admin PIN&rdquo;ï¼Œæ‰€ä»¥æ‡‰è©²æ˜¯ä¸å¤ªæœƒçœ‹éŒ¯å•¦ã€‚é è¨­æ˜¯ 12345678<br><code>gpg --edit-card</code> åœ¨ <code>passwd</code> è£¡ä¿®æ”¹ Admin PIN å¾Œçš„è¨Šæ¯æœƒæ˜¯ <code>PIN changed.</code>ï¼Œæ‡‰è©²æ˜¯èª¤æ¤å§</p><h2 id=management-key>management key</h2><p>é€™æ˜¯ä¸€å€‹æ¯”è¼ƒç‰¹åˆ¥çš„å¯†ç¢¼ï¼Œä»–é è¨­æ˜¯ 3DESï¼Œä½ ä¹Ÿå¯ä»¥æ”¹æˆ AESï¼Œç›®å‰ä¾†èªª 3DES é‚„æ˜¯ã€Œå®‰å…¨çš„åŠ å¯†æ¨™æº–ã€ï¼Œæ‰€ä»¥é‡å°é€™å€‹å¯†ç¢¼ yubikey æ²’æœ‰è¨­å®šå˜—è©¦ä¸Šé™ï¼ˆPIN å’Œ PUK æœ‰ï¼‰ï¼Œå› ç‚ºå°±ç®—æ”»æ“Šè€…æƒ³è¦ç ´è§£ä¹Ÿå¾ˆé›£ï¼ˆ<a class=link href=https://zh.wikipedia.org/wiki/3DES#%E5%AE%89%E5%85%A8%E6%80%A7 target=_blank rel=noopener>3DES çš„å®‰å…¨æ€§</a>ï¼‰</p><h3 id=ä½¿ç”¨æƒ…å¢ƒ-2>ä½¿ç”¨æƒ…å¢ƒ</h3><ul><li>ä¿®æ”¹ management key</li><li>ä¿®æ”¹è³‡æ–™</li><li>ç”¢ç”Ÿæ–°é‡‘é‘°å°</li><li>åŒ¯å…¥å¯†é‘°</li><li>ç”¢ç”Ÿæ†‘è­‰</li><li>ä¿®æ”¹å˜—è©¦æ¬¡æ•¸é™åˆ¶</li></ul><p>ä»¥ä¸Šå…§å®¹æ˜¯æ ¹æ“š <a class=link href=https://docs.yubico.com/yesdk/users-manual/application-piv/pin-puk-mgmt-key.html target=_blank rel=noopener>é€™ç¯‡æ–‡ä»¶</a> æ•´ç†å‡ºä¾†çš„</p><blockquote><p>æ ¹æ“š <a class=link href=https://developers.yubico.com/yubikey-piv-manager/PIN_and_Management_Key.html target=_blank rel=noopener>é€™ç¯‡æ–‡ç« </a>ï¼Œä¼¼ä¹é‚„æœ‰å…¶ä»–å¯†ç¢¼å€‘ï¼Œä¸Šé¢ä»‹ç´¹çš„éƒ½æ˜¯å±¬æ–¼ PIVï¼ˆPersonal Identity Verificationï¼‰ï¼Œé‚„æœ‰ OpenPGPã€FIDO2 çš„ PIN</p></blockquote></section><footer class=article-footer><section class=article-tags><a href=/tags/yubikey/>yubikey</a>
<a href=/tags/ssh/>ssh</a>
<a href=/tags/gpg/>GPG</a>
<a href=/tags/security/>security</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css integrity="sha256-J+iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js integrity="sha256-InsNdER1b2xUewP+pKCUJpkhiqwHgqiPXDlIk7GzBu4=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI=" crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸é—œæ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/linux/docker/wireshark-over-ssh-in-docker/><div class=article-image><img src=/og/linux/docker/wireshark-over-ssh-in-docker.png loading=lazy data-key=wireshark-over-ssh-in-docker data-hash=/og/linux/docker/wireshark-over-ssh-in-docker.png></div><div class=article-details><h2 class=article-title>Wireshark Over SSH in Docker</h2></div></a></article><article class=has-image><a href=/p/linux/gpg-yubikey/><div class=article-image><img src=/og/linux/gpg-yubikey.png loading=lazy data-key=gpg-yubikey data-hash=/og/linux/gpg-yubikey.png></div><div class=article-details><h2 class=article-title>GPG and Yubikey</h2></div></a></article><article class=has-image><a href=/p/linux/server/ssh-on-gitea-with-docker/><div class=article-image><img src=/og/linux/server/ssh-on-gitea-with-docker.png loading=lazy data-key=ssh-on-gitea-with-docker data-hash=/og/linux/server/ssh-on-gitea-with-docker.png></div><div class=article-details><h2 class=article-title>ssh on gitea with docker</h2></div></a></article><article class=has-image><a href=/p/linux/gpg/><div class=article-image><img src=/og/linux/gpg.png loading=lazy data-key=gpg data-hash=/og/linux/gpg.png></div><div class=article-details><h2 class=article-title>GPG</h2></div></a></article><article class=has-image><a href=/p/linux/ssh-tunnel/><div class=article-image><img src=/og/linux/ssh-tunnel.png loading=lazy data-key=ssh-tunnel data-hash=/og/linux/ssh-tunnel.png></div><div class=article-details><h2 class=article-title>SSH Tunnel</h2></div></a></article></div></div></aside><div id=gitalk-container></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css><script src=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/blueimp-md5@2.18.0/js/md5.min.js></script>
<script>const gitalk=new Gitalk({clientID:"eeb2b2f9e0bfe34ffde9",clientSecret:"2a10208c164a8fab8622b497674285bc48a203d8",repo:"blog",owner:"simbafs",admin:["simbafs"],distractionFreeMode:!1,id:md5(location.pathname)});(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("gitalk-container").innerHTML="Gitalk comments not available by default when the website is previewed locally.";return}gitalk.render("gitalk-container")})()</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2023 Simba çš„å–µçª©</section><section class=powerby>å¥½æƒ³é¤Šè²“é˜¿~~<br>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> å»ºç«‹<br>ä¸»é¡Œ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.20.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è¨­è¨ˆ</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>